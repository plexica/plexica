# ===================================================================
# Plexica Test Environment Configuration
# ===================================================================
# This file contains environment variables for running tests
# All services use different ports to avoid conflicts with production

# Node Environment
NODE_ENV=test

# Database (Test PostgreSQL on port 5433)
DATABASE_URL="postgresql://plexica_test:plexica_test_password@localhost:5433/plexica_test?schema=core"
DATABASE_USER="plexica_test"

# Redis (Test Redis on port 6380)
REDIS_HOST="localhost"
REDIS_PORT="6380"
REDIS_PASSWORD=""

# Keycloak (Test Keycloak on port 8081)
KEYCLOAK_URL="http://localhost:8081"
KEYCLOAK_REALM="plexica-test"
KEYCLOAK_CLIENT_ID="plexica-test-api"
KEYCLOAK_CLIENT_SECRET="test-client-secret"
KEYCLOAK_ADMIN_USERNAME="admin"
KEYCLOAK_ADMIN_PASSWORD="admin"

# MinIO / S3 (Test MinIO on ports 9010/9011)
MINIO_ENDPOINT="localhost"
MINIO_PORT="9010"
MINIO_ACCESS_KEY="minioadmin_test"
MINIO_SECRET_KEY="minioadmin_test"
MINIO_USE_SSL="false"
MINIO_PUBLIC_URL="http://localhost:9010"

# Legacy storage variables (for compatibility)
STORAGE_ENDPOINT="localhost:9010"
STORAGE_ACCESS_KEY="minioadmin_test"
STORAGE_SECRET_KEY="minioadmin_test"
STORAGE_USE_SSL="false"

# Redpanda / Kafka (Test Redpanda on port 9095)
REDPANDA_BROKERS="localhost:9095"
KAFKA_BROKERS="localhost:9095"
KAFKA_CLIENT_ID="plexica-test-client"
KAFKA_CONSUMER_GROUP_ID="plexica-test-consumer"

# API Configuration
API_PORT="3000"
API_HOST="0.0.0.0"

# Authentication
# Tests should NOT bypass auth - we test with real Keycloak tokens
BYPASS_AUTH="false"

# JWT Configuration
JWT_SECRET="test-jwt-secret-key-do-not-use-in-production"
JWT_EXPIRATION="1h"

# OAuth 2.0 Configuration
OAUTH_CALLBACK_URL="http://localhost:3001/auth/callback"
JWKS_CACHE_TTL="600000"

# Rate Limiting Configuration
AUTH_RATE_LIMIT_MAX="10"
AUTH_RATE_LIMIT_WINDOW="60000"

# CORS Configuration
CORS_ORIGIN="http://localhost:3001,http://localhost:3002"

# Logging
LOG_LEVEL="error"

# Test-specific settings
TEST_TIMEOUT=30000
TEST_SEQUENTIAL=true
